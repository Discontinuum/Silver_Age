#textdomain wesnoth-2

[multiplayer]
    id=2p_Silver_age_surv
    name= _ "1p - A nasty mage (survival)"
    description= _ "674 YW. Northern Wesnoth is engulfed in flames of a war between paladins and silver magicians. Two sects of zealots are not afraid of either the Queen or the Gods, as they declare their intention to fight “for justice” even at the cost of destroying the whole humanity along with the opponent. In the midst of this rampage is you, modest military commander, trying to defend the interests of your faction…

How many turns would it take to appease the raging silver sorceress? Ten? Or maybe fifty? I promise that you will hate this girl.

TIP: you can change the difficulty, changing the amount of starting gold. More gold for you means more gold for your opponent."
    turns=-1
    experience_modifier=100
    map_data="{~add-ons/Silver_Age/scenarios/NM.map}"
    victory_when_enemies_defeated=no
    allow_era=era_SA
    force_lock_settings=yes

    {DEFAULT_SCHEDULE}
    {DEFAULT_MUSIC_PLAYLIST}

    [side]
        side=1
        team_name="player"
        user_team_name= _ "teamname^You"
        controller="human"
        save_id="Player1"
        fog="yes"
        shroud="no"
	gold_lock="false"
	faction_lock="false"
	leader_lock="false"
    [/side]

    [side]
        side=2
        no_leader=yes
	faction=Custom
	leader_lock="true"
	faction_lock="true"
	controller_lock="true"
        team_name="silver"
        user_team_name= _ "teamname^Silver mages"
        controller="ai"
        save_id="Player2"
        gold=0
        fog="yes"
        shroud="no"
	[ai]
	   passive_leader=yes
	   [avoid]
		terrain=W*,Sm
    	   [/avoid]
	   [goal]
		name=target_location
		[criteria]
		    x=13-17
		    y=2-5
		[/criteria]
		value=5
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=13-17
		    y=2-5
		    [filter_adjacent]
		    	side=2
		    	{IS_MAGE}
		    [/filter_adjacent]
		[/criteria]
		value=6
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=11-14
		    y=4-7
		    [filter_adjacent]
		    	side=2
		    	{IS_MAGE}
		    [/filter_adjacent]
		[/criteria]
		value=11
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=11-14
		    y=4-7
		[/criteria]
		value=10
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=11-14
		    y=4-7
		    [filter_adjacent]
		    	side=2
		    	{IS_MAGE}
		    [/filter_adjacent]
		[/criteria]
		value=11
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=8-12
		    y=8-11
		[/criteria]
		value=16
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=8-12
		    y=8-11
		    [filter_adjacent]
		    	side=2
		    	{IS_MAGE}
		    [/filter_adjacent]
		[/criteria]
		value=17
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=7-15
		    y=12-15
		[/criteria]
		value=24
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=7-15
		    y=12-15
		    [filter_adjacent]
		    	side=2
		    	{IS_MAGE}
		    [/filter_adjacent]
		[/criteria]
		value=25
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=7-17
		    y=16-19
		[/criteria]
		value=34
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=7-17
		    y=16-19
		    [filter_adjacent]
		    	side=2
		    	{IS_MAGE}
		    [/filter_adjacent]
		[/criteria]
		value=35
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=7-17
		    y=20-23
		[/criteria]
		value=46
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=7-17
		    y=20-23
		    [filter_adjacent]
		    	side=2
		    	{IS_MAGE}
		    [/filter_adjacent]
		[/criteria]
		value=47
	   [/goal]
	   [goal]
		name=target
		[criteria]
		    side=1
		[/criteria]
		value=50
	   [/goal]
	   [goal]
		name=target_location
		[criteria]
		    x=15
		    y=21
		    [filter]
		    [/filter]
		[/criteria]
		value=50
	   [/goal]
    	   [aspect]
        	id=aggression
        	[facet]
            	    id=custom_aggressionA
            	    time_of_day=morning, midday, afternoon
            	    value=0.4
        	[/facet]
        	[facet]
            	    id=custom_aggressionB
            	    time_of_day=first_watch, midnight, second_watch
            	    value=0.0
        	[/facet]
        	[facet]
            	    id=custom_aggressionC
            	    time_of_day=dusk, dawn
            	    value=0.2
        	[/facet]
    	   [/aspect]
  	   [aspect]
    	        id=recruitment_instructions
    		[facet]
      		    [value] 
        		[recruit]
          		    type=scout
          		    number=2
          		    total=yes
          		    importance=4
        		[/recruit]
        		[recruit]
          		    type=healer
          		    number=1
          		    total=yes
          		    importance=3
			    blocker=no
        		[/recruit]
        		[recruit]
          		    type=fighter
			    number=2
			    total=yes
			    importance=2
			    blocker=no
        		[/recruit]
        		[recruit]
          		    type=mixed fighter
			    importance=1
			    blocker=no
        		[/recruit]
        		[recruit]
			    importance=0
        		[/recruit]		
      		    [/value]
    		[/facet]
  	    [/aspect]
	    [aspect]
    		id=recruitment_save_gold
    		[facet]
      		   [value]
		       active=1
		       begin=1.25
        	       end=0.75
		       spend_all_gold=200
      		   [/value]
    		[/facet]
  	    [/aspect]
	[/ai]
    [/side]

    [side]
        side=3
        no_leader=yes
	faction=Custom
	leader_lock="true"
	faction_lock="true"
	controller_lock="true"
        team_name="paladins"
    	recruit=Royal Light Pikeman, Royal Archer, Royal Light Infantryman, Royal Heavy Infantryman, Royal Dragoon, Royal Squire, Royal White Mage Temp
	color=teal
        user_team_name= _ "teamname^Paladins"
        controller="ai"
        save_id="Player2"
        gold=0
        fog="yes"
        shroud="no"
	[ai]
	   passive_leader=yes
	   [avoid]
		terrain=W*,Sm
    	   [/avoid]
	   [goal]
		name=target_location
		[criteria]
		    x=14
		    y=21
		[/criteria]
		value=15
	   [/goal]
    	   [aspect]
        	id=aggression
        	[facet]
            	    id=custom_aggressionA
            	    time_of_day=morning, midday, afternoon
            	    value=0.4
        	[/facet]
        	[facet]
            	    id=custom_aggressionB
            	    time_of_day=first_watch, midnight, second_watch
            	    value=0.0
        	[/facet]
        	[facet]
            	    id=custom_aggressionC
            	    time_of_day=dusk, dawn
            	    value=0.2
        	[/facet]
    	   [/aspect]
  	   [aspect]
    	        id=recruitment_instructions
    		[facet]
      		    [value] 
        		[recruit]
          		    type=Royal Squire
          		    number=2
          		    total=yes
          		    importance=4
        		[/recruit]
        		[recruit]
          		    type=Royal Dragoon
          		    number=3
          		    total=yes
          		    importance=3
			    blocker=no
        		[/recruit]
        		[recruit]
          		    type=healer
			    number=2
			    importance=2
			    blocker=no
        		[/recruit]
        		[recruit]
          		    type=Royal Heavy Infantryman
			    number=3
			    total=yes
			    importance=1
			    blocker=no
        		[/recruit]
        		[recruit]
			    importance=0
        		[/recruit]		
      		    [/value]
    		[/facet]
  	    [/aspect]
	    [aspect]
    		id=recruitment_save_gold
    		[facet]
      		   [value]
		       active=1
		       begin=1.25
        	       end=0.75
		       spend_all_gold=200
      		   [/value]
    		[/facet]
  	    [/aspect]
	[/ai]
    [/side]

#define RA_REPLIC TEXT
    [if]
    [have_unit]
	side=1
	canrecruit=yes
	trait=patriot
    [/have_unit]
    [then]
  	[message]
	    side=1
	    canrecruit=yes
	    message={TEXT}
	[/message]
    [/then]
    [/if]  
#enddef
#define MFNU_REPLIC TEXT
    [if]
    [have_unit]
	side=1
	canrecruit=yes
	trait=undead leader
    [/have_unit]
    [then]
  	[message]
	    side=1
	    canrecruit=yes
	    message={TEXT}
	[/message]
    [/then]
    [/if]  
#enddef
#define BS_REPLIC TEXT
    [if]
    [have_unit]
	side=1
	canrecruit=yes
	trait=vile
    [/have_unit]
    [then]
  	[message]
	    side=1
	    canrecruit=yes
	    message={TEXT}
	[/message]
    [/then]
    [/if]  
#enddef
#define THT_REPLIC TEXT
    [if]
    [have_unit]
	side=1
	canrecruit=yes
	trait=strong
    [/have_unit]
    [then]
  	[message]
	    side=1
	    canrecruit=yes
	    message={TEXT}
	[/message]
    [/then]
    [/if]  
#enddef
#define NMUNIT NAME TYPE X Y SIDE FACING
    [unit]
	type={TYPE}
	side={SIDE}
	name={NAME}
	x={X}
	y={Y}
	random_traits=yes
	random_gender=yes
	facing={FACING}
	[status]
	    guardian=yes
	[/status]	
    [/unit]
#enddef
#define TOMBSTONE X Y
    [item]
	x,y={X},{Y}
	image=scenery/monolith2.png
    [/item]   
#enddef
    [terrain_graphics]
	[tile]
	    x=0
	    y=0
	    type=Rb
	[/tile]
	[tile]
	    x=0
	    y=1
	    type=Rb
	[/tile]
	[tile]
	    x=0
	    y=2
	    type=Rb
	[/tile]
	[tile]
	    x=1
	    y=0
	[/tile]
	[tile]
	    x=1
	    y=1
	    type=*^Em
	[/tile]
	[tile]
	    x=2
	    y=1
	[/tile]
	[tile]
	    x=2
  	    y=2
    	[/tile]
    	[image]
	    center=105,155
	    name="kitchen-silver-mage.png~RC(magenta>red)"
    	[/image]
    [/terrain_graphics]
    [event]
	name=prestart
	{TOMBSTONE 20 34}
	{TOMBSTONE 21 34}
	{TOMBSTONE 22 33}
	{TOMBSTONE 19 34}
	{TOMBSTONE 20 33}
	{TOMBSTONE 21 33}
        [item]
	    x,y=19,32
	    image=scenery/rock-cairn.png
    	[/item]   
        [unit]
	    id=Nasty
	    type=Royal Silver Mage Temp
	    gender=female
	    side=2
	    name=_"Anastasia Hightower"
	    x=21
	    y=3
	    canrecruit=yes
	    [modifications]
		{TRAIT_BEAUTIFUL}
		[object]
		    silent=yes
		    {BASIC_WATERBALL 0}
		    [effect]
           		apply_to=remove_attacks
	   		name=staff
        	    [/effect]		    
        	    {AVERAGE_ICE_PIKE 0}
		    {SET_SILVER_MAGE}
		    {AVERAGE_DISPELLING_STORM}
		    [effect]
	    		apply_to=type
	    		name=Royal Silver Mage
		    [/effect]
		[/object]
	    [/modifications]
        [/unit]

	[store_side]
	    side=1
	    variable=playerside
	[/store_side]
	[gold]
	    side=2
	    amount=$playerside.gold
	[/gold]
	[gold]
	    side=2
	    amount=50
	[/gold]
	[allow_recruit]
	    side=2
	    type=Royal Apprentice Mage, Robber Mercenary, Monster Wolf
	[/allow_recruit]
        [objectives]
            side=1
            [objective]
                description= _ "Mysterious castle appeared in the northern forest. Explore it."
                condition=win
            [/objective]
            [objective]
                description= _ "Death of your leader."
                condition=lose
            [/objective]
        [/objectives]
    [/event]
    [event]
	name=moveto
	first_time_only=no
	[filter]
	    side=1
	    [filter_adjacent]
	    	side=2
		canrecruit=yes
	    [/filter_adjacent]
	[/filter]
	[modify_side]
	    side=2
	    [ai]
		passive_leader=no
	    [/ai]
	[/modify_side]
    [/event]
    [event]
	name=moveto
	first_time_only=no
	[filter]
	    side=1
	    [filter_adjacent]
	    	side=3
		canrecruit=yes
	    [/filter_adjacent]
	[/filter]
	[modify_side]
	    side=3
	    [ai]
		passive_leader=no
	    [/ai]
	[/modify_side]
    [/event]
#define CLEAR_SPOT NUM
    {VARIABLE spot {NUM}}
    [color_adjust]
	red=0
	green=20
	blue=20
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=40
	blue=40
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=60
	blue=60
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=80
	blue=80
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=100
	blue=100
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=120
	blue=120
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=140
	blue=140
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=160
	blue=160
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=180
	blue=180
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=200
	blue=200
    [/color_adjust]
    [kill]
	type=Monster Fire Crystal, Monster Cold Crystal, Monster Fire Gargoyle, Monster Cold Gargoyle
	animate=no
	fire_event=no
    [/kill]
    [switch]
	variable=spot
	[case]
	    value=0
    	    [terrain]
		x=20
		y=2-3
		terrain=Rd
	    [/terrain]
    	    [terrain]
		x=21
		y=2-4
		terrain=Rd
	    [/terrain]
    	    [terrain]
		x=22
		y=2-3
		terrain=Rd
	    [/terrain]
	[/case]
	[case]
	    value=1
    	    [terrain]
		x=12
		y=4-5
		terrain=Hhd
	    [/terrain]
    	    [terrain]
		x=13
		y=4-6
		terrain=Hhd
	    [/terrain]
    	    [terrain]
		x=14
		y=4-5
		terrain=Hhd
	    [/terrain]
	[/case]
	[case]
	    value=2
    	    [terrain]
		x=1
		y=3-4
		terrain=Hhd
	    [/terrain]
    	    [terrain]
		x=2
		y=2-4
		terrain=Hhd
	    [/terrain]
    	    [terrain]
		x=3
		y=3-4
		terrain=Hhd
	    [/terrain]
	[/case]
	[case]
	    value=3
    	    [terrain]
		x=3
		y=35-36
		terrain=Rd
	    [/terrain]
    	    [terrain]
		x=4
		y=34-36
		terrain=Rd
	    [/terrain]
    	    [terrain]
		x=5
		y=35-36
		terrain=Rd
	    [/terrain]
	[/case]
	[case]
	    value=4
    	    [terrain]
		x=20
		y=20-21
		terrain=Rd
	    [/terrain]
    	    [terrain]
		x=21
		y=20-22
		terrain=Rd
	    [/terrain]
    	    [terrain]
		x=22
		y=20-21
		terrain=Rd
	    [/terrain]
	[/case]
	[case]
	    value=5
    	    [terrain]
		x=28
		y=5-6
		terrain=Wo
	    [/terrain]
    	    [terrain]
		x=29
		y=5-7
		terrain=Wo
	    [/terrain]
    	    [terrain]
		x=30
		y=5-6
		terrain=Wo
	    [/terrain]
	[/case]
	[case]
	    value=6
    	    [terrain]
		x=17
		y=39-40
		terrain=Wwf
	    [/terrain]
    	    [terrain]
		x=18
		y=38-40
		terrain=Wwf
	    [/terrain]
    	    [terrain]
		x=19
		y=39-40
		terrain=Wwf
	    [/terrain]
	[/case]
	[case]
	    value=7
    	    [terrain]
		x=3
		y=18-19
		terrain=Uue
	    [/terrain]
    	    [terrain]
		x=4
		y=18-19
		terrain=Uue
	    [/terrain]
    	    [terrain]
		x=4
		y=17
		terrain=Qxe
	    [/terrain]
    	    [terrain]
		x=5
		y=18-19
		terrain=Uue
	    [/terrain]
	[/case]
    [/switch]
    [redraw]
    [/redraw]
    [color_adjust]
	red=0
	green=180
	blue=180
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=160
	blue=160
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=140
	blue=140
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=120
	blue=120
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=100
	blue=100
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=80
	blue=80
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=60
	blue=60
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=40
	blue=40
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=20
	blue=20
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=0
	blue=0
    [/color_adjust]
    {CLEAR_VARIABLE spot}
#enddef
#define KILLUNITS X1 X2 X3 Y1 Y2 Y3
    [if]
    [have_unit]
	side=1
	x={X1}
	[and]
	    y={Y1}
	    [or]
		y={Y2}
	    [/or]
	[/and]
	[or]
	    side=1
	    x={X2}
	    [and]
	    	y={Y1}
	    	[or]
		    y={Y2}
		    [or]
			y={Y3}
		    [/or]
	    	[/or]
	    [/and]	
	[/or]
	[or]
	    side=1
	    x={X3}
	    [and]
	    	y={Y1}
	    	[or]
		    y={Y2}
	    	[/or]
	    [/and]	
	[/or]
    [/have_unit]
    [then]
	[message]
	    speaker=narrator
	    message=_"Your units were killed by a fallen castle!"
	[/message]	
    [/then]
    [/if]
    [kill]
	x={X1}
	[and]
	    y={Y1}
	    [or]
		y={Y2}
	    [/or]
	[/and]
	[or]
	    x={X2}
	    [and]
	    	y={Y1}
	    	[or]
		    y={Y2}
		    [or]
			y={Y3}
		    [/or]
	    	[/or]
	    [/and]	
	[/or]
	[or]
	    x={X3}
	    [and]
	    	y={Y1}
	    	[or]
		    y={Y2}
	    	[/or]
	    [/and]	
	[/or]	
	animate=no
	fire_event=yes
    [/kill]
#enddef
#define LAND_SPOT NUM
    {VARIABLE spot {NUM}}
    [color_adjust]
	red=0
	green=20
	blue=20
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=40
	blue=40
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=60
	blue=60
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=80
	blue=80
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=100
	blue=100
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=120
	blue=120
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=140
	blue=140
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=160
	blue=160
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=180
	blue=180
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=200
	blue=200
    [/color_adjust]
    [switch]
	variable=spot
	[case]
	    value=1
	    [scroll_to]
    		x=13
    		y=5
    		immediate=yes
	    [/scroll_to]
	    {KILLUNITS 12 13 14 4 5 6}
    	    [terrain]
		x=12
		y=4
		terrain=Ch^Ve
	    [/terrain]
    	    [terrain]
		x=12
		y=5
		terrain=Kv
	    [/terrain]
    	    [terrain]
		x=13
		y=4-5
		terrain=Kv
	    [/terrain]
    	    [terrain]
		x=13
		y=6
		terrain=Ch
	    [/terrain]
    	    [terrain]
		x=14
		y=4
		terrain=Ch
	    [/terrain]
    	    [terrain]
		x=14
		y=5
		terrain=Kv
	    [/terrain]
    	    {QUAKE "cave-in.ogg"}
   	    [redraw]
    	    [/redraw]
	    [teleport]
		[filter]
		    canrecruit=yes
		    side=2
		[/filter]
		x=13
		y=5
		animate=no
	    [/teleport]
	[/case]
	[case]
	    value=2
	    [scroll_to]
    		x=2
    		y=3
    		immediate=yes
	    [/scroll_to]
	    {KILLUNITS 1 2 3 3 4 2}
    	    [terrain]
		x=1
		y=3
		terrain=Ch
	    [/terrain]
    	    [terrain]
		x=1
		y=4
		terrain=Kv
	    [/terrain]
    	    [terrain]
		x=2
		y=2-3
		terrain=Kv
	    [/terrain]
    	    [terrain]
		x=2
		y=4
		terrain=Ch
	    [/terrain]
    	    [terrain]
		x=3
		y=3
		terrain=Ch^Ve
	    [/terrain]
    	    [terrain]
		x=3
		y=4
		terrain=Kv
	    [/terrain]
    	    {QUAKE "cave-in.ogg"}
   	    [redraw]
    	    [/redraw]
	    [teleport]
		[filter]
		    canrecruit=yes
		    side=2
		[/filter]
		x=2
		y=3
		animate=no
	    [/teleport]
	[/case]
	[case]
	    value=3
	    [scroll_to]
    		x=4
    		y=35
    		immediate=yes
	    [/scroll_to]
	    {KILLUNITS 3 4 5 35 36 34}
    	    [terrain]
		x=3
		y=35
		terrain=Ch
	    [/terrain]
    	    [terrain]
		x=3
		y=36
		terrain=Kv
	    [/terrain]
    	    [terrain]
		x=4
		y=34-35
		terrain=Kv
	    [/terrain]
    	    [terrain]
		x=4
		y=36
		terrain=Ch^Ve
	    [/terrain]
    	    [terrain]
		x=5
		y=35
		terrain=Ch
	    [/terrain]
    	    [terrain]
		x=5
		y=36
		terrain=Kv
	    [/terrain]
    	    {QUAKE "cave-in.ogg"}
   	    [redraw]
    	    [/redraw]
	    [teleport]
		[filter]
		    canrecruit=yes
		    side=2
		[/filter]
		x=4
		y=35
		animate=no
	    [/teleport]
	[/case]
	[case]
	    value=4
	    [scroll_to]
    		x=21
    		y=21
    		immediate=yes
	    [/scroll_to]
	    {KILLUNITS 20 21 22 20 21 22}
    	    [terrain]
		x=20
		y=20
		terrain=Ch
	    [/terrain]
    	    [terrain]
		x=20
		y=21
		terrain=Kv
	    [/terrain]
    	    [terrain]
		x=21
		y=20-21
		terrain=Kv
	    [/terrain]
    	    [terrain]
		x=21
		y=22
		terrain=Ch
	    [/terrain]
    	    [terrain]
		x=22
		y=20
		terrain=Ch^Ve
	    [/terrain]
    	    [terrain]
		x=22
		y=21
		terrain=Kv
	    [/terrain]
    	    {QUAKE "cave-in.ogg"}
   	    [redraw]
    	    [/redraw]
	    [teleport]
		[filter]
		    canrecruit=yes
		    side=2
		[/filter]
		x=21
		y=21
		animate=no
	    [/teleport]
	[/case]
	[case]
	    value=5
	    [scroll_to]
    		x=29
    		y=6
    		immediate=yes
	    [/scroll_to]
	    {KILLUNITS 28 29 30 5 6 7}
    	    [terrain]
		x=28
		y=5
		terrain=Chw^Ve
	    [/terrain]
    	    [terrain]
		x=28
		y=6
		terrain=Kvr
	    [/terrain]
    	    [terrain]
		x=29
		y=5-6
		terrain=Kvr
	    [/terrain]
    	    [terrain]
		x=29
		y=7
		terrain=Chw
	    [/terrain]
    	    [terrain]
		x=30
		y=5
		terrain=Chw
	    [/terrain]
    	    [terrain]
		x=30
		y=6
		terrain=Kvr
	    [/terrain]
	    {NMUNIT _"Crystal" (Monster Fire Crystal) 30 5 2 n}
	    {NMUNIT _"Crystal" (Monster Cold Crystal) 29 7 2 n}
    	    {QUAKE "cave-in.ogg"}
   	    [redraw]
    	    [/redraw]
	    [teleport]
		[filter]
		    canrecruit=yes
		    side=2
		[/filter]
		x=29
		y=6
		animate=no
	    [/teleport]
	[/case]
	[case]
	    value=6
	    [scroll_to]
    		x=18
    		y=39
    		immediate=yes
	    [/scroll_to]
	    {KILLUNITS 17 18 19 39 40 38}
    	    [terrain]
		x=17
		y=39
		terrain=Chs
	    [/terrain]
    	    [terrain]
		x=17
		y=40
		terrain=Kvr
	    [/terrain]
    	    [terrain]
		x=18
		y=38-39
		terrain=Kvr
	    [/terrain]
    	    [terrain]
		x=18
		y=40
		terrain=Chs^Ve
	    [/terrain]
    	    [terrain]
		x=19
		y=39
		terrain=Chs
	    [/terrain]
    	    [terrain]
		x=19
		y=40
		terrain=Kvr
	    [/terrain]
	    {NMUNIT _"Crystal" (Monster Fire Crystal) 17 39 2 n}
	    {NMUNIT _"Crystal" (Monster Cold Crystal) 19 39 2 n}
    	    {QUAKE "cave-in.ogg"}
   	    [redraw]
    	    [/redraw]
	    [teleport]
		[filter]
		    canrecruit=yes
		    side=2
		[/filter]
		x=18
		y=39
		animate=no
	    [/teleport]
	[/case]
	[case]
	    value=7
	    [scroll_to]
    		x=4
    		y=18
    		immediate=yes
	    [/scroll_to]
	    {KILLUNITS 3 4 5 18 19 17}
    	    [terrain]
		x=3
		y=18
		terrain=Chr^Ve
	    [/terrain]
    	    [terrain]
		x=3
		y=19
		terrain=Kvr
	    [/terrain]
    	    [terrain]
		x=4
		y=17-18
		terrain=Kvr
	    [/terrain]
    	    [terrain]
		x=4
		y=19
		terrain=Chr
	    [/terrain]
    	    [terrain]
		x=5
		y=18
		terrain=Chr
	    [/terrain]
    	    [terrain]
		x=5
		y=19
		terrain=Kvr
	    [/terrain]
	    {NMUNIT _"Crystal" (Monster Fire Crystal) 5 18 2 n}
	    {NMUNIT _"Crystal" (Monster Cold Crystal) 4 19 2 n}
    	    {QUAKE "cave-in.ogg"}
   	    [redraw]
    	    [/redraw]
	    [teleport]
		[filter]
		    canrecruit=yes
		    side=2
		[/filter]
		x=4
		y=18
		animate=no
	    [/teleport]
	[/case]
	[case]
	    value=8
	    [scroll_to]
    		x=15
    		y=21
    		immediate=yes
	    [/scroll_to]
	    {KILLUNITS 14 15 16 20 21 22}
    	    [terrain]
		x=14
		y=20-21
		terrain=Chr
	    [/terrain]
    	    [terrain]
		x=15
		y=20
		terrain=Chr
	    [/terrain]
    	    [terrain]
		x=15
		y=21
		terrain=Kvr
	    [/terrain]
    	    [terrain]
		x=15
		y=22
		terrain=Chr
	    [/terrain]
    	    [terrain]
		x=16
		y=20
		terrain=Chr
	    [/terrain]
    	    [terrain]
		x=16
		y=21
		terrain=Chr^Ve
	    [/terrain]
    	    {QUAKE "cave-in.ogg"}
   	    [redraw]
    	    [/redraw]
	    [teleport]
		[filter]
		    canrecruit=yes
		    side=2
		[/filter]
		x=15
		y=21
		animate=no
	    [/teleport]
	[/case]
    [/switch]
    [color_adjust]
	red=0
	green=180
	blue=180
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=160
	blue=160
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=140
	blue=140
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=120
	blue=120
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=100
	blue=100
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=80
	blue=80
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=60
	blue=60
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=40
	blue=40
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=20
	blue=20
    [/color_adjust]
    [delay]
	time=20
    [/delay]
    [color_adjust]
	red=0
	green=0
	blue=0
    [/color_adjust]
    {CLEAR_VARIABLE spot}
#enddef
#define CHOISE_1
    [message]
	speaker=narrator
	image="portraits/royal-army/transparent/silver-mage+female.png"
	message=_"*sob* Thank… you… I am… sorry. I am absolutely surrender myself to your mercy and will order my surviving soldiers to fight alongside you."
    [/message]
    [modify_unit]
	[filter]
	     side=2
	[/filter]
	side=1
    [/modify_unit]
    [objectives]
        side=1
        [objective]
            description= _ "Protect your “booty”."
            condition=win
        [/objective]
        [objective]
            description= _ "Death of your leader."
            condition=lose
        [/objective]
        [objective]
            description= _ "Anastasia seized by paladins."
            condition=lose
        [/objective]
    [/objectives]	
#enddef
#define CHOISE_2
    [kill]
	side=1
	animate=no
	fire_event=no
    [/kill]
    [message]
	speaker=narrator
	image=portraits/book.png
	message=_"You've gave the mage away and successfully retreated. Perhaps Anastasia did deserve her sad fate, but you still feel that you have done something wrong."
    [/message]
    [endlevel]
        result=victory
    [/endlevel]
#enddef
#define PALADINS
    [set_variable]
	name=ps
	rand=1..3
    [/set_variable]
    [switch]
	variable=ps
	[case]
	    value=1
   	    [unit]
		type=Royal Paladin
    		side=3
		name=_"Knight-Commander"
		x=1
		y=33
		canrecruit=yes
		[modifications]
	    	     {TRAIT_RESILIENT_DIVINE}	
		[/modifications]
    	    [/unit]
	    [terrain]
		x=1
		y=33
		terrain=Ke
	    [/terrain]
	    [terrain]
		x=1
		y=32
		terrain=Ce
	    [/terrain]
	    [terrain]
		x=1
		y=34
		terrain=Ce
	    [/terrain]
	[/case]
	[case]
	    value=2
   	    [unit]
		type=Royal Paladin
    		side=3
		name=_"Knight-Commander"
		x=28
		y=35
		canrecruit=yes
		[modifications]
	    	     {TRAIT_RESILIENT_DIVINE}	
		[/modifications]
    	    [/unit]
	    [terrain]
		x=28
		y=35
		terrain=Ke
	    [/terrain]
	    [terrain]
		x=29
		y=35
		terrain=Ce
	    [/terrain]
	    [terrain]
		x=27
		y=36
		terrain=Ce
	    [/terrain]
	[/case]
	[case]
	    value=3
   	    [unit]
		type=Royal Paladin
    		side=3
		name=_"Knight-Commander"
		x=30
		y=11
		canrecruit=yes
		[modifications]
	    	     {TRAIT_RESILIENT_DIVINE}	
		[/modifications]
    	    [/unit]
	    [terrain]
		x=30
		y=11
		terrain=Ke
	    [/terrain]
	    [terrain]
		x=29
		y=11
		terrain=Ce
	    [/terrain]
	    [terrain]
		x=30
		y=10
		terrain=Ce
	    [/terrain]
	[/case]
    [/switch]
    {CLEAR_VARIABLE cs}
    {CLEAR_VARIABLE playerside}
    [store_side]
	side=1
	variable=yourside
    [/store_side]
    [gold]
	side=3
	amount=$yourside.gold
    [/gold]
    {CLEAR_VARIABLE yourside}
    [store_unit]
	[filter]
	    side=1
	    canrecruit=no
	    [not]
		x=recall
		y=recall
	    [/not]
	[/filter]
	kill=no
	variable=yourunits
    [/store_unit]
    {FOREACH yourunits yu}
	{VARIABLE cn 0}
	[if]
	[have_location]
	    [filter_adjacent_location]
	    	[filter]
		    side=3
		    type=Royal Paladin
	    	[/filter]
		count=3
	    [/filter_adjacent_location]
	    terrain=Rb, Gs*, Gs^Efm
	    x=1-30
	    y=1-40
	[/have_location]
	[then]
	    {VARIABLE cn 3}
	[/then]
	[else]
	    [if]
	    [have_location]
	    	[filter_adjacent_location]
	     	    [filter]
		    	side=3
		    	type=Royal Paladin
	    	    [/filter]
		    count=2
	    	[/filter_adjacent_location]
	    	terrain=Rb, Gs*, Gs^Efm
		x=1-30
		y=1-40
	    [/have_location]
	    [then]
	    	{VARIABLE cn 2}
	    [/then]
	    [else]
		[if]
	    	[have_location]
	    	    [filter_adjacent_location]
	     	    	[filter]
		     	    side=3
		    	    type=Royal Paladin
	    	        [/filter]
	    	    [/filter_adjacent_location]
	    	    terrain=Rb, Gs*, Gs^Efm
		    x=1-30
		    y=1-40
	    	[/have_location]
		[then]
	    	    {VARIABLE cn 1}
		[/then]
		[/if]
	    [/else]
	    [/if]
	[/else]
	[/if]
	[if]
	[variable]
	    name=cn
	    greater_than=0
	[/variable]
	[then]
	    [store_locations]
	    	[filter_adjacent_location]
	    	    [filter]
		    	side=3
		    	type=Royal Paladin
	    	    [/filter]
		    count=$cn
	    	[/filter_adjacent_location]
	    	terrain=Rb, Gs*, Gs^Efm
		x=1-30
		y=1-40
		variable=locs
	    [/store_locations]
	    [unit]
		type=Royal Paladin
    		side=3
		random_traits=yes
		generate_name=yes
		x=$locs[0].x
		y=$locs[0].y
    	     [/unit]
	     [terrain]
	    	[filter]
		    type=Royal Paladin
    		    side=3
		    canrecruit=no
		[/filter]
	    	terrain=Ce
	     [/terrain]
	     {CLEAR_VARIABLE locs}
	     {CLEAR_VARIABLE cn}
	[/then]
	[/if]
    {NEXT yu}
#enddef
    [event]
	name=sighted
 	[filter]
	    side=2
	    canrecruit=yes
	[/filter] 

	{RA_REPLIC (_"A silver mage? That's not good. It always was better not to mess with them, but after they began ther war with paladins things got even worse.")}
	{MFNU_REPLIC (_"A silver mage? What is she doing here? I thought all of them too busy fighting paladins… But Lord Hakar said “Capture and take for questioning any silver mages you will face.” Looks like he foreseen all of this.")}
	{BS_REPLIC (_"What? Is this a silver mage? I've never seen one… They tell a lot of horror stories about them, but it can't be so terrible.")}
	{THT_REPLIC (_"Wow! This red-haired shaman is kinda leader, right? Nice boobs for a human girl!")}
    [/event]
    [event]
	name=attacker hits
	[filter_second]
	    id=Nasty
	[/filter_second]
	[message]
	    speaker=Nasty
	    message=_"Do you hope to cope with me like that?"
	[/message]
	[teleport]
	    [filter]
		id=Nasty
	    [/filter]
	    x=30
	    y=26
	    animate=yes
	[/teleport]
	{CLEAR_SPOT 0}
	[message]
	    side=1
	    canrecruit=yes
	    message=_"What the…"
	[/message]
    	[set_variable]
	    name=cs
	    rand=1..4
    	[/set_variable]
	{LAND_SPOT $cs}
	[gold]
	    side=2
	    amount=$playerside.gold
	[/gold]
	[gold]
	    side=2
	    amount=$playerside.gold
	[/gold]
	[disallow_recruit]
	    side=2
	    type=Royal Apprentice Mage, Robber Mercenary, Monster Wolf
	[/disallow_recruit]
	[allow_recruit]
	    side=2
	    type=Robber Fugitive Mage Temp, Robber Antiquarian, Robber Ogre Soldier, Monster Crow
	[/allow_recruit]
	[if]
	[variable]
	    name=cs
	    equals=4
	[/variable]
	[then]
	    [if]
	    [have_unit]
		side=1
		canrecruit=yes
		x=7-17
		y=16-23
	    [/have_unit]
	    [then]
		{RA_REPLIC (_"Fuckin' witch! She is attacking our camp!!")}
		{MFNU_REPLIC (_"What an interesting move… but do you hope to cope with me like that?")}
		{BS_REPLIC (_"Bitchy witch! You can't trick us so easily!")}
		{THT_REPLIC (_"Wow! Do you flew here to fight me in person? You are really a daughter of a strongman!")}
	    [/then]
	    [else]
		[message]
		    side=1
		    canrecruit=yes
		    message=_"IT'S A TRAP! She’s planning to take our camp!"
		[/message]
	    [/else]
	    [/if]
	[/then]
	[/if]
    	[heal_unit]
	    [filter]
	   	id=Nasty
	    [/filter]
	    amount=full
    	[/heal_unit]
        [objectives]
            side=1
            [objective]
                description= _ "Catch up with the flying castle and deal with the mage."
                condition=win
            [/objective]
            [objective]
                description= _ "Death of your leader."
                condition=lose
            [/objective]
        [/objectives]
	[modify_side]
	    side=2
	    [ai]
		passive_leader=yes
	    [/ai]
	[/modify_side]
	[modify_unit]
	    [filter]
		id=Nasty
	    [/filter]
	    id=Nasty2
	[/modify_unit]
    [/event]
    [event]
	name=last breath
	[filter]
	    id=Nasty2
	[/filter]
	[message]
	    speaker=Nasty2
	    message=_"You could at least change your tactics a bit, you know… I’ll just do it again."
	[/message]
	[teleport]
	    [filter]
		id=Nasty2
	    [/filter]
	    x=30
	    y=26
	    animate=yes
	[/teleport]
	{CLEAR_SPOT $cs}
	[message]
	    canrecruit=yes
	    side=1
	    message=_"Crap, she did it again!"
	[/message]
	{CLEAR_VARIABLE cs}
    	[set_variable]
	    name=cs
	    rand=5..7
    	[/set_variable]
	{LAND_SPOT $cs}
	[gold]
	    side=2
	    amount=300
	[/gold]
	[gold]
	    side=2
	    amount=$playerside.gold
	[/gold]
	[disallow_recruit]
	    side=2
	    type=Robber Fugitive Mage Temp, Robber Cook, Robber Ogre Soldier, Monster Crow
	[/disallow_recruit]
	[allow_recruit]
	    side=2
	    type=Monster Mantikore, Undead Poltergeist, Undead Vampire
	[/allow_recruit]
    	[heal_unit]
	    [filter]
	   	id=Nasty2
	    [/filter]
	    amount=full
    	[/heal_unit]
	{RA_REPLIC (_"Well, guys, we've a new plan. I was told by competent people that magical castle should have two magical crystals which making it to fly. If we find and crush at least one of them, this witch wouldn't escape anymore.")}
	{MFNU_REPLIC (_"At least we got an answer from HQ… Oh. Looks like this castle should have two magical crystals as power source. If we find and crush at least one of them, it can't teleport anymore.")}
	{BS_REPLIC (_"Well, i asked a familiar mage and he said there should be some crystals which making castle to fly. Let's find and crush them!")}
	{THT_REPLIC (_"Shaman of Vod-ha-bodung said me they have some big crystal things to make their castle fly. I didn't understand much, as the old man was drunk as hell… Let's just take to the flying castle and crush everything there.")}
	[object]
           silent=yes
           duration=forever

           [filter]
                type=Monster Cold Crystal
           [/filter]

           [effect]
                apply_to=remove_advancement
                types=Monster Cold Guardian
           [/effect]
	[/object]
	[object]
           silent=yes
           duration=forever

           [filter]
                type=Monster Fire Crystal
           [/filter]

           [effect]
                apply_to=remove_advancement
                types=Monster Fire Guardian
           [/effect]
	[/object]
        [objectives]
            side=1
            [objective]
                description= _ "Destroy a magic crystal and catch a nasty mage!"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of your leader."
                condition=lose
            [/objective]
        [/objectives]
	[modify_side]
	    side=2
	    [ai]
		passive_leader=yes
	    [/ai]
	[/modify_side]
	[modify_unit]
	    [filter]
		id=Nasty2
	    [/filter]
	    id=Nasty3
	[/modify_unit]
    [/event]
    [event]
	name=last breath
	[filter]
	    id=Nasty3
	[/filter]
	[message]
	    speaker=Nasty3
	    message=_"You have good soldiers, but with such a foolish commander they have no chance. Time to solve it once and for all."
	[/message]
	[teleport]
	    [filter]
		id=Nasty3
	    [/filter]
	    x=30
	    y=26
	    animate=yes
	[/teleport]
	{CLEAR_SPOT $cs}
	{LAND_SPOT 8}
	[gold]
	    side=2
	    amount=$playerside.gold
	[/gold]
	[gold]
	    side=2
	    amount=$playerside.gold
	[/gold]
	[gold]
	    side=2
	    amount=$playerside.gold
	[/gold]
	[gold]
	    side=2
	    amount=$playerside.gold
	[/gold]
	[gold]
	    side=2
	    amount=100
	[/gold]
	[disallow_recruit]
	    side=2
	    type=Monster Mantikore, Undead Poltergeist, Undead Vampire
	[/disallow_recruit]
	[allow_recruit]
	    side=2
	    type=Royal Silver Mage Temp, Monster Enchanted Crow, Royal Silver Mage Relic, Robber Slayer
	[/allow_recruit]
    	[heal_unit]
	    [filter]
	   	id=Nasty3
	    [/filter]
	    amount=full
    	[/heal_unit]
	[message]
	    side=1
	    canrecruit=yes
	    message=_"FUCKIN' BITCH!!! Our camp is destroyed!"
	[/message]
        [objectives]
            side=1
            [objective]
                description= _ "Defeat the nasty mage!!!"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of your leader."
                condition=lose
            [/objective]
        [/objectives]
	[lift_fog]
	    [filter_side]
		side=1
	    [/filter_side]
	    x=14-16
	    y=20-22
	[/lift_fog]
	[message]
	    speaker=Nasty3
	    message=_"Ooops… Looks like i overdid it. That piece of garbage is unlikely to be able to fly in the near future."
	[/message]
	[modify_side]
	    side=2
	    [ai]
		passive_leader=yes
	    [/ai]
	[/modify_side]
	[modify_unit]
	    [filter]
		id=Nasty3
	    [/filter]
	    id=Nasty4
	[/modify_unit]
    [/event]
    [event]
	name=last breath
	first_time_only=no
	[filter]
	    type=Monster Cold Crystal, Monster Cold Gargoyle
	[/filter]
	[message]
	    speaker=Nasty3
	    message=_"Oh, so you know about magical crystals? Not bad… but still not enough."
	[/message]
	[modify_side]
	    side=2
	    [ai]
		passive_leader=no
	    [/ai]
	[/modify_side]
	[sound]
	    name=magic-dark.wav
	[/sound]
    	[heal_unit]
	    [filter]
	   	x=$x1
		y=$y1
	    [/filter]
	    amount=full
    	[/heal_unit]
	{RA_REPLIC (_"Crap! Looks like damned witch can repair crystal with her ice magic… But that's unlikely she can do this trick with fire crystal. Let's try to crush it!!")}
	{MFNU_REPLIC (_"I heard about this. Each of silver mages has second specialization. Looks like this chick is ice mage. But i doubt she'll be able to fix fire crystal like that!")}
	{BS_REPLIC (_"WHAT THE FUCK!! And what to do now? Maybe we just must try another crystal, or do it several times? It's too damn hard… Why we haven't consultant mage or something like that?")}
	{THT_REPLIC (_"Wow! She just fixed it. That woman has power equal to size of her boobs! But we're clevermen, right? Let's crush a red crystal and look if she can to fix it too!")}	
    [/event]
    [event]
	name=last breath
	[filter]
	    type=Monster Fire Crystal, Monster Fire Gargoyle
	[/filter]
	[message]
	    speaker=Nasty3
	    message=_"So, you managed to deprive my castle of teleportation capacity… I am ALMOST impressed."
	[/message]
	[kill]
	    type=Monster Fire Crystal, Monster Cold Crystal, Monster Fire Gargoyle, Monster Cold Gargoyle
	    animate=no
	    fire_event=no    
	[/kill]
	[message]
	    side=1
	    canrecruit=yes
	    message=_"Yeah. You can’t escape anymore!"
	[/message]
	[message]
	    speaker=Nasty3
	    message=_"Correction: MY CASTLE can't escape anymore. It doesn't affect my OWN ability to teleport… And there is still one HQ I can borrow."
	[/message]
	[teleport]
	    [filter]
		id=Nasty3
	    [/filter]
	    x=15
	    y=21
	    animate=yes
	[/teleport]
	[gold]
	    side=2
	    amount=$playerside.gold
	[/gold]
	[gold]
	    side=2
	    amount=$playerside.gold
	[/gold]
	[gold]
	    side=2
	    amount=$playerside.gold
	[/gold]
	[gold]
	    side=2
	    amount=$playerside.gold
	[/gold]
	[gold]
	    side=2
	    amount=100
	[/gold]
	[disallow_recruit]
	    side=2
	    type=Monster Mantikore, Undead Poltergeist, Undead Vampire
	[/disallow_recruit]
	[allow_recruit]
	    side=2
	    type=Royal Silver Mage Temp, Monster Enchanted Crow, Royal Silver Mage Relic, Robber Slayer
	[/allow_recruit]
    	[heal_unit]
	    [filter]
	   	id=Nasty3
	    [/filter]
	    amount=full
    	[/heal_unit]
	[message]
	    side=1
	    canrecruit=yes
	    message=_"…"
	[/message]
        [if]
        [have_unit]
	    side=1
	    x=12-18
	    y=18-24
        [/have_unit]
        [then]
	    [message]
	    	speaker=Nasty3
	    	message=_"I'm sorry, guys. Would you like to take a walk, please?"
	    [/message]
	    [store_unit]
		[filter]
	    	    side=1
	    	    x=12-18
	    	    y=18-24		    
		[/filter]
		kill=no
		variable=teleporters
	    [/store_unit]
	    [sound]
	    	name=magic-dark-big.wav
	    [/sound]
	    {FOREACH teleporters tb}
    		[set_variable]
	    	    name=rx
	    	    rand=1..25
    		[/set_variable]
    		[set_variable]
		    name=ry
		    rand=24..36
    		[/set_variable]
		[teleport]
	    	   [filter]
		      id=$teleporters[$tb].id
	    	   [/filter]
	    	   x=$rx
	    	   y=$ry
	    	   animate=no
		[/teleport]
		{CLEAR_VARIABLE rx}
	        {CLEAR_VARIABLE ry}	
	    {NEXT tb}
	    {CLEAR_VARIABLE teleporters}
	    [if]
	    [have_unit]
		id=Nasty3
		[not]
		    x=15
		    y=21
		[/not]
	    [/have_unit]
	    [then]
		[teleport]
	    	   [filter]
		      id=Nasty3
	    	   [/filter]
	    	   x=15
	    	   y=21
	    	   animate=no
		[/teleport]	
	    [/then]
	    [/if]
        [/then]
        [/if]
        [objectives]
            side=1
            [objective]
                description= _ "Defeat the nasty mage!!!"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of your leader."
                condition=lose
            [/objective]
        [/objectives]	
	[modify_side]
	    side=2
	    [ai]
		passive_leader=yes
	    [/ai]
	[/modify_side]
	[modify_unit]
	    [filter]
		id=Nasty3
	    [/filter]
	    id=Nasty4
	[/modify_unit]
    [/event]
    [event]
	name=last breath
	first_time_only=no
	[filter]
	    i=Nasty4
	[/filter]
	{RA_REPLIC (_"At last! It's time to pay for all mess you made, witch!")}
	{MFNU_REPLIC (_"Got you! Lord Hakar will be pleased… Maybe he'll even let me to keep you after you answer all questions… if you survive the questioning.")}
	{BS_REPLIC (_"Gotcha, fuckin' witch! Now we can have fun with her, guys!")}
	{THT_REPLIC (_"We're the winners! Now i want you to make four or five flying castles for my tribe, woman!")}
	[kill]
	    id=Nasty4
	    animate=no
	    fire_event=no  
	[/kill]
        {PLACE_IMAGE "units/royal-army/mages/silver-mage/female-disarmed.png~RC(magenta>blue)" 14 21}
        {PLACE_IMAGE items/cage-high.png 14 21}
	{PALADINS}
	[lift_fog]
	    [filter_side]
		side=1
	    [/filter_side]
	    [filter]
		side=3
	    [/filter]
	[/lift_fog]
	[message]
	    side=3
	    canrecruit=yes
	    message=_"Stop it, now! Immediately give us a mage named Anastasia Hightower and all of her property. Anyone who dare to harbor the criminal will be destroyed!"
	[/message]
	{RA_REPLIC (_"Oh, shit… As if this crazy girl isn't enough for us!")}
	{MFNU_REPLIC (_"SHIT! What a bad timing! It's your fault, woman, why didn't you surrender half an hour earlier?")}
	{BS_REPLIC (_"What the heck? I'm not ready to meet such a fuckin' horde of paladins!")}
	{THT_REPLIC (_"Hey, you! I caught this woman first! Now both her and flying castles belong to me and my tribe!")}
	[scroll_to]
    	    x=14
    	    y=21
	[/scroll_to]
	[message]
	    speaker=narrator
	    caption=_"Anastasia Hightower"
	    image="portraits/royal-army/transparent/silver-mage+female.png"
	    message=_"Don't give me away! Please! They certainly will burn me! I admit I am a bad woman, but do not deserve THAT! Please! *sob* please…"
	[/message]
    	[if]
    	[have_unit]
	    side=1
	    canrecruit=yes
	    trait=patriot
    	[/have_unit]
    	[then]
  	    [message]
	    	side=1
	    	canrecruit=yes
	    	message=_"Shut up, woman! You aren't the one who have the right to decide something here. Probably i should give you away and look how they will burn you…"
            	[option]
                    label= _ "But that's absolutely illegal. You are the criminal, captured by the Royal Army, and therefore should stand the Royal trial. I can't just give you to gang of zealots… Moreover, how they dare to threaten us, Her Majesty's soldiers? Let's beat all the shit out of them, guys!"
                    [command]
                    	{CHOISE_1}
                    [/command]
            	[/option]
            	[option]
                    label= _ "Moreover, how my people supposed to fight this fuckin' paladins army? Blame not me, but the one who put us in this untenable situation. We're leaving guys! Let mages and paladins to solve their problems themselves."
                    [command]
		        {CHOISE_2}
                    [/command]
            	[/option]
	    [/message]
    	[/then]
    	[/if]  
    	[if]
    	[have_unit]
	    side=1
	    canrecruit=yes
	    trait=undead leader
    	[/have_unit]
    	[then]
  	    [message]
	    	side=1
	    	canrecruit=yes
	    	message=_"I wasn't ready to fight paladins… and why all of you are here, again? Something that i can't understand is happening, obviously…"
            	[option]
                    label= _ "But i can't disobey order of my master. If he had foreseen all of this and sent me to death, escape wouldn't save me. Moreover, i can't just let such a great-looking chick to be burned. Let's fight and see what will happen."
                    [command]
		        {CHOISE_1}                  
                    [/command]
            	[/option]
            	[option]
                    label= _ "It can not be helped. Maybe we can escape while the paladins are burning you… nothing personal, darling, but you are unlucky today."
                    [command]
		        {CHOISE_2}
                    [/command]
            	[/option]
	    [/message]
    	[/then]
    	[/if]  
    	[if]
    	[have_unit]
	    side=1
	    canrecruit=yes
	    trait=vile
    	[/have_unit]
    	[then]
  	    [message]
	    	side=1
	    	canrecruit=yes
	    	message=_"Oh, so you'd prefer to stay with my boys? Right, at least they won't burn you, hehe…"
            	[option]
                    label= _ "Well, we've already defeated a famous silver mage, so what this self-proclaimed heroes can do? Their armours looks like they were made two centuries ago! Give them hell, boys!"
                    [command]
  		        {CHOISE_1}                  
                    [/command]
            	[/option]
            	[option]
                    label= _ "But there is no way we will fight a ton of paladins for one bitch! We're getting out, boys!"
                    [command]
		        {CHOISE_2}
                    [/command]
            	[/option]
	    [/message]
    	[/then]
    	[/if]  
    	[if]
    	[have_unit]
	    side=1
	    canrecruit=yes
	    trait=strong
    	[/have_unit]
    	[then]
  	    [message]
	    	side=1
	    	canrecruit=yes
	    	message=_"Be silent! I'm the leader here and you just close your mouth and do what i say."
            	[option]
                    label= _ "Of course I'm not going to give you to anyone. Prepare yourself to serve me whole your life. As for you, white-helmed knights, prepare yourselves to death!"
                    [command]
  		        {CHOISE_1}                      
                    [/command]
            	[/option]
            	[option]
                    label= _ "Here should be option to gave up the mage and retreat, but orcish strongmen can never give up. So fight and win or fight and die - that's all of your options!"
                    [command]
			[kill]
			    side=2
			    animate=no
			    fire_event=no
			[/kill]
			[scroll_to]
    			    x=14
    			    y=21
			[/scroll_to]
			[message]
	    		    speaker=narrator
	    		    caption=_"Anastasia Hightower"
	    		    image="portraits/royal-army/transparent/silver-mage+female.png"
	    		    message=_"I… i can… i am sorry… erm… my lord… but I can’t make flying castles… But I’ll gladly do anything else if you don’t give me to paladins!"
			[/message]	
			[message]
			    side=1
			    canrecruit=yes
			    message=_"Tush! At least you know how to cook borsch?"
			[/message]
			[scroll_to]
    			    x=14
    			    y=21
			[/scroll_to]
			[message]
	    		    speaker=narrator
	    		    caption=_"Anastasia Hightower"
	    		    image="portraits/royal-army/transparent/silver-mage+female.png"
	    		    message=_"Erm… of course, my lord…"
			[/message]
			[message]
			    side=1
			    canrecruit=yes
			    message=_"I see. It seems your only talent is to anger men and make them want to throw you into fire… Goblins! Teach her to cook!"
			[/message]	 
     			[remove_item]
			    x=14
			    y=21
     			[/remove_item]
        		[terrain]
			    x=14
			    y=21
			    layer=overlay
			    terrain="^Em"
			[/terrain]
       			{NMUNIT _"Ugly goblinesses" (Tribes Kitchen) 14 22 1 n}
       			{NMUNIT _"Ugly goblinesses" (Tribes Kitchen) 13 22 1 n}
        		[objectives]
            		    side=1
            		    [objective]
                		description= _ "Protect your “booty”."
                		condition=win
            		    [/objective]
           	 	    [objective]
                		description= _ "Death of your leader."
                		condition=lose
            		    [/objective]
           	 	    [objective]
                		description= _ "Anastasia seized by paladins."
                		condition=lose
            		    [/objective]
        		[/objectives]	
                    [/command]
            	[/option]
	    [/message]
    	[/then]
    	[/if] 
	[sound]
	    name=magic-dark.wav
	[/sound]
    [/event]
    [event]
	name=moveto
	[filter]
	   x=14
	   y=21
	   side=3
	[/filter]
	[message]
	    side=3
	    canrecruit=yes
	    message=_"We got her!"
	[/message]
	[scroll_to]
    	    x=14
    	    y=21
	[/scroll_to]
	[message]
	    speaker=narrator
	    caption=_"Anastasia Hightower"
	    image="portraits/royal-army/transparent/silver-mage+female.png"
	    message=_"No! No! Don't come to me!"
	[/message]
	[message]
	    side=3
	    canrecruit=yes
	    message=_"Anastasia Hightower, you're under arrest on charges of witchcraft and theft of dangerous artifacts. You have the right to make a will."
	[/message]
    	[endlevel]
            result=defeat
    	[/endlevel]
    [/event]
    [event]
	name=last breath
	[filter]
	    side=3
	    canrecruit=yes
	[/filter]
	[kill]
	    side=3
	    canrecruit=yes
	    animate=yes
	    fire_event=no	
	[/kill]
    	[store_unit]
	    [filter]
	    	side=3
	    	canrecruit=no
	    [/filter]	
	    variable=pals
	    kill=no
    	[/store_unit]
    	{FOREACH pals pu}
	    [move_unit]
		id=$pals[pu].id
		to_x=30
		to_y=40
	    [/move_unit]
	    [kill]
	    	id=$pals[pu].id
	    	animate=no
	    	fire_event=no	
	    [/kill]
    	{NEXT pu}
    	{CLEAR_VARIABLE pals}	
    	[if]
    	[have_unit]
	    side=1
	    canrecruit=yes
	    trait=patriot
    	[/have_unit]
    	[then]
  	    [message]
	    	side=1
	    	canrecruit=yes
	    	message=_"Good job, everyone. That's enough adventures for today – let's just take our captive to Weldyn."
	    [/message]
	    [scroll_to]
    	    	x=14
    	   	y=21
	    [/scroll_to]
	    [message]
	    	speaker=narrator
	    	caption=_"Anastasia Hightower"
	    	image="portraits/royal-army/transparent/silver-mage+female.png"
	    	message=_"Oh, so i am not a fuckin' witch anymore?"
	    [/message]
  	    [message]
	    	side=1
	    	canrecruit=yes
	    	message=_"I'm just too tired to swear… How the hell one woman can cause so much troubles…"
	    [/message]
    	    [kill]
		side=1
		animate=no
		fire_event=no
    	    [/kill]
     	    [remove_item]
		x=14
		y=21
     	    [/remove_item]
    	    [message]
		speaker=narrator
		image=portraits/book.png
		message=_"Two months later war between silver mages and paladins ended after latters destroyed main flying city and confiscated the most dangerous artifacts. Queen declared amnesty for all participants of the conflict, and those of the mages, whom still weren't burned by the paladins, were released. Anastasia Hightower also was one of them. Such ending can be considered as happyend for everyone, save the question of for what your soldiers have died, after all."
    	    [/message]
    	[/then]
    	[/if]  
    	[if]
    	[have_unit]
	    side=1
	    canrecruit=yes
	    trait=undead leader
    	[/have_unit]
    	[then]
  	    [message]
	    	side=1
	    	canrecruit=yes
	    	message=_"Wow. We really did that! Now it doesn't matter if Lord Hakar planned me to die or not. Since i won, no one will indict me."
	    [/message]
	    [scroll_to]
    	    	x=14
    	    	y=21
	    [/scroll_to]
	    [message]
	    	speaker=narrator
	    	caption=_"Anastasia Hightower"
	    	image="portraits/royal-army/transparent/silver-mage+female.png"
	    	message=_"Erm… and what about me?"
	    [/message]
  	    [message]
	    	side=1
	    	canrecruit=yes
	    	message=_"Don't worry, i never heard about Lord Hakar tortured someone to death. Answer all the questions and you'll be allowed to stay with us."
	    [/message]
    	    [kill]
		side=1
		animate=no
		fire_event=no
    	    [/kill]
     	    [remove_item]
		x=14
		y=21
     	    [/remove_item]
    	    [message]
		speaker=narrator
		image=portraits/book.png
		message=_"By the time you returned to the Necropolis, Mal Hakar had already received all the necessary information so he didn't interrogate Anastasia. Young woman became one of many mages who willingly joined the Necromancers Union. You lived happily ever after."
    	    [/message]
    	[/then]
    	[/if]  
    	[if]
    	[have_unit]
	    side=1
	    canrecruit=yes
	    trait=vile
    	[/have_unit]
    	[then]
  	    [message]
	    	side=1
	    	canrecruit=yes
	    	message=_"Have you seen that? We beat all of them! Now we booze!"
	    [/message]
    	    [kill]
		side=1
		animate=no
		fire_event=no
    	    [/kill]
     	    [remove_item]
		x=14
		y=21
     	    [/remove_item]
    	    [message]
		speaker=narrator
		image=portraits/book.png
		message=_"Grabbing all the loot and the captured sorceress, the gang set off in an unknown direction. Since then, nobody saw both them and unfortunate Anastasia Hightower."
    	    [/message]
    	[/then]
    	[/if]  
    	[if]
    	[have_unit]
	    side=1
	    canrecruit=yes
	    trait=strong
    	[/have_unit]
    	[then]
  	    [message]
	    	side=1
	    	canrecruit=yes
	    	message=_"We're the winners! Again. Is there anyone else who wants to fight me for this woman?"
	    [/message]
    	    [kill]
		side=1
		animate=no
		fire_event=no
    	    [/kill]
     	    [remove_item]
		x=14
		y=21
     	    [/remove_item]
            [terrain]
		x=14
		y=21
		layer=overlay
		terrain="^"
	    [/terrain]
    	    [message]
		speaker=narrator
		image=portraits/book.png
		message=_"Since there was no answer, chief took Anastasia and went back to his place, so no one saw the silver mage on the lands of Wesnoth again. Maybe that wasn't an ending she dreamed about, but at least she lived a long (although not carefree) life…"
    	    [/message]
    	[/then]
    	[/if] 
    	[endlevel]
            result=victory
    	[/endlevel]
    [/event]
    [event]
	name=attacker hits
	[filter_second]
	    canrecruit=yes
	    status=sleeped
	    gender=female
	[/filter_second]
	[filter_attack]
	    special=take corpse
	[/filter_attack]
	[filter]
	    level=3-4
	[/filter]
	[message]
	    x=$x2
	    y=$y2
	    caption=_"Possessed mage"
	    message=_"I got her, master."
	[/message]
  	[message]
	    side=1
	    canrecruit=yes
	    message=_"Nice. Now get her down on all fours and say “woof, woof”"
	[/message]
	[message]
	    x=$x2
	    y=$y2
	    caption=_"Possessed mage"
	    message=_"You have too violent fantasy, master. We haven't time for that."
	[/message]
	{PALADINS}
	[lift_fog]
	    [filter_side]
		side=1
	    [/filter_side]
	    [filter]
		side=3
	    [/filter]
	[/lift_fog]
	[message]
	    side=3
	    canrecruit=yes
	    message=_"Stop it, now! Immediately give us a mage named Anastasia Hightower and all of her property. Anyone who dare to harbor the criminal will be destroyed!"
	[/message]
	[message]
	    x=$x2
	    y=$y2
	    caption=_"Possessed mage"
	    message=_"Ha-ha! Fuck you, stupid paladins! We've already got everything we need."
	[/message]
  	[message]
	    side=1
	    canrecruit=yes
	    message=_"Right. Let's getting out of here."
	[/message]
    	[kill]
	    side=1,2
	    animate=no
	    fire_event=no
    	[/kill]
	[message]
	    speaker=narrator
	    image=portraits/book.png
	    message=_"You've succesfully escaped paladins' revenge and delivered valuable information from the nasty mage's brains to your master. As for woman herself, her body became a toy of necromancers for eternity. That is is the lesson for anyone who dare to oppose the disciples of Mal Hakar."
        [/message]
	[endlevel]
            result=victory
    	[/endlevel]	
    [/event]
    [event]
	name=attack end
	first_time_only=no
	[filter_second]
	    canrecruit=yes
	    status=sleeped
	    gender=male
	[/filter_second]
	[filter_attack]
	    special=take corpse
	[/filter_attack]
	[filter]
	    level=3-4
	[/filter]
	[message]
	    x=$x2
	    y=$y2
	    message=_"Begone, demon!"
	[/message]
	[kill]
	    x=$x1
	    y=$y1
	    animate=yes
	    fire_event=yes
	[/kill]
  	[message]
	    side=1
	    canrecruit=yes
	    message=_"Wow. Looks like this paladin is invulnerable for corpse theft… I've never seen something like that before."
	[/message]
	[message]
	    speaker=narrator
	    caption=_"Anastasia Hightower"
	    image="portraits/royal-army/transparent/silver-mage+female.png"
	    message=_"Sorry… you have so many troubles because of me…"
	[/message]
	[message]
	    side=1
	    canrecruit=yes
	    message=_"None at all. Losing some skeletons is nothing, but the longer it goes the more of intel we get."
	[/message]
    [/event]
[/multiplayer]
